{"ast":null,"code":"var _jsxFileName = \"D:\\\\ITSS\\\\frontend\\\\src\\\\page\\\\Login.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useContext } from \"react\";\nimport { TextField, Button, Box, Typography, Alert } from \"@mui/material\";\nimport { useNavigate } from \"react-router-dom\";\nimport { loginAction } from \"../api/api\";\nimport api from \"../api/axios\"; // Import axios instance để gọi API /auth\nimport { AuthContext } from \"../context/AuthContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Login = () => {\n  _s();\n  const navigate = useNavigate();\n  const {\n    setAuth\n  } = useContext(AuthContext); // Lấy hàm setAuth từ Context\n\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [error, setError] = useState(null);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setError(null);\n    try {\n      // 1. Gọi API đăng nhập\n      const response = await loginAction({\n        email,\n        password\n      });\n      const {\n        token\n      } = response.data;\n\n      // 2. Chỉ đặt header cho các request trong phiên làm việc hiện tại\n      // localStorage.setItem(\"token\", token); // <= XÓA DÒNG NÀY\n      api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n\n      // 3. Dùng token vừa nhận để lấy thông tin người dùng\n      const userResponse = await api.get('/auth');\n\n      // 4. Cập nhật AuthContext với đầy đủ thông tin\n      setAuth({\n        isAuthenticated: true,\n        token: token,\n        user: userResponse.data\n      });\n\n      // 4. Chuyển hướng đến Dashboard sau 1 giây\n      setTimeout(() => {\n        navigate(\"/\"); // Chuyển về trang chủ (Dashboard)\n      }, 1000);\n    } catch (apiError) {\n      var _apiError$response, _apiError$response$da;\n      const errorMsg = ((_apiError$response = apiError.response) === null || _apiError$response === void 0 ? void 0 : (_apiError$response$da = _apiError$response.data) === null || _apiError$response$da === void 0 ? void 0 : _apiError$response$da.msg) || \"ログインに失敗しました (Đăng nhập thất bại).\";\n      setError(errorMsg);\n      console.error(\"Login error:\", apiError);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Box, {\n    sx: {\n      maxWidth: 400,\n      margin: \"auto\",\n      mt: 10,\n      padding: 3,\n      boxShadow: 3,\n      borderRadius: 2,\n      backgroundColor: \"white\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"h4\",\n      align: \"center\",\n      gutterBottom: true,\n      children: \"\\u30ED\\u30B0\\u30A4\\u30F3\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      children: [error && /*#__PURE__*/_jsxDEV(Alert, {\n        severity: \"error\",\n        sx: {\n          mb: 2\n        },\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 19\n      }, this), /*#__PURE__*/_jsxDEV(TextField, {\n        label: \"\\u30E1\\u30FC\\u30EB\",\n        variant: \"outlined\",\n        fullWidth: true,\n        margin: \"normal\",\n        type: \"email\",\n        value: email,\n        onChange: e => setEmail(e.target.value),\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TextField, {\n        label: \"\\u30D1\\u30B9\\u30EF\\u30FC\\u30C9\",\n        type: \"password\",\n        variant: \"outlined\",\n        fullWidth: true,\n        margin: \"normal\",\n        value: password,\n        onChange: e => setPassword(e.target.value),\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        type: \"submit\",\n        variant: \"contained\",\n        color: \"primary\",\n        fullWidth: true,\n        sx: {\n          mt: 2,\n          mb: 2\n        },\n        children: \"\\u30ED\\u30B0\\u30A4\\u30F3\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 5\n  }, this);\n};\n_s(Login, \"9r/DtxWDUWhzRCpjr+n89u/rFJk=\", false, function () {\n  return [useNavigate];\n});\n_c = Login;\nexport default Login;\nvar _c;\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["React","useState","useContext","TextField","Button","Box","Typography","Alert","useNavigate","loginAction","api","AuthContext","jsxDEV","_jsxDEV","Login","_s","navigate","setAuth","email","setEmail","password","setPassword","error","setError","handleSubmit","e","preventDefault","response","token","data","defaults","headers","common","userResponse","get","isAuthenticated","user","setTimeout","apiError","_apiError$response","_apiError$response$da","errorMsg","msg","console","sx","maxWidth","margin","mt","padding","boxShadow","borderRadius","backgroundColor","children","variant","align","gutterBottom","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","severity","mb","label","fullWidth","type","value","onChange","target","required","color","_c","$RefreshReg$"],"sources":["D:/ITSS/frontend/src/page/Login.jsx"],"sourcesContent":["import React, { useState, useContext } from \"react\";\r\nimport {\r\n  TextField,\r\n  Button,\r\n  Box,\r\n  Typography,\r\n  Alert,\r\n} from \"@mui/material\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { loginAction } from \"../api/api\";\r\nimport api from \"../api/axios\"; // Import axios instance để gọi API /auth\r\nimport { AuthContext } from \"../context/AuthContext\";\r\n\r\nconst Login = () => {\r\n  const navigate = useNavigate();\r\n  const { setAuth } = useContext(AuthContext); // Lấy hàm setAuth từ Context\r\n\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [error, setError] = useState(null);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setError(null);\r\n\r\n    try {\r\n      // 1. Gọi API đăng nhập\r\n      const response = await loginAction({ email, password });\r\n      const { token } = response.data;\r\n\r\n      // 2. Chỉ đặt header cho các request trong phiên làm việc hiện tại\r\n      // localStorage.setItem(\"token\", token); // <= XÓA DÒNG NÀY\r\n      api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n\r\n      // 3. Dùng token vừa nhận để lấy thông tin người dùng\r\n      const userResponse = await api.get('/auth');\r\n\r\n      // 4. Cập nhật AuthContext với đầy đủ thông tin\r\n      setAuth({\r\n        isAuthenticated: true,\r\n        token: token,\r\n        user: userResponse.data,\r\n      });\r\n\r\n      // 4. Chuyển hướng đến Dashboard sau 1 giây\r\n      setTimeout(() => {\r\n        navigate(\"/\"); // Chuyển về trang chủ (Dashboard)\r\n      }, 1000);\r\n\r\n    } catch (apiError) {\r\n      const errorMsg = apiError.response?.data?.msg || \"ログインに失敗しました (Đăng nhập thất bại).\";\r\n      setError(errorMsg);\r\n      console.error(\"Login error:\", apiError);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Box\r\n      sx={{\r\n        maxWidth: 400,\r\n        margin: \"auto\",\r\n        mt: 10,\r\n        padding: 3,\r\n        boxShadow: 3,\r\n        borderRadius: 2,\r\n        backgroundColor: \"white\",\r\n      }}\r\n    >\r\n      <Typography variant=\"h4\" align=\"center\" gutterBottom>\r\n        ログイン\r\n      </Typography>\r\n\r\n      <form onSubmit={handleSubmit}>\r\n        {error && <Alert severity=\"error\" sx={{ mb: 2 }}>{error}</Alert>}\r\n        <TextField\r\n          label=\"メール\"\r\n          variant=\"outlined\"\r\n          fullWidth\r\n          margin=\"normal\"\r\n          type=\"email\"\r\n          value={email}\r\n          onChange={(e) => setEmail(e.target.value)}\r\n          required\r\n        />\r\n        <TextField\r\n          label=\"パスワード\"\r\n          type=\"password\"\r\n          variant=\"outlined\"\r\n          fullWidth\r\n          margin=\"normal\"\r\n          value={password}\r\n          onChange={(e) => setPassword(e.target.value)}\r\n          required\r\n        />\r\n        <Button\r\n          type=\"submit\"\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          fullWidth\r\n          sx={{ mt: 2, mb: 2 }}\r\n        >\r\n          ログイン\r\n        </Button>\r\n      </form>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default Login;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}